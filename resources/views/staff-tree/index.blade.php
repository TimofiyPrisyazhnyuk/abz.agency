@extends('layouts.app_staff')@push('css')    <link href="{{ asset('css/appStaffTreeIndex.css') }}" rel="stylesheet" type="text/css">@endpush@section('header')    @include('staff-list.header_staff_list')@endsection@section('content')    <div id="staff_tree">        <div class="title">            <div class="alert">                <h2>Tree Users - task â„–1</h2>            </div>        </div>        <div class="container">            <div class="row">                <div class="col-md-12">                    <div id="staffTree">                    </div>                </div>            </div>        </div>    </div>@endsection@section('footer')    @include('staff-list.footer_staff_list')@endsection@push('scripts')    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/themes/default/style.min.css"/>    <script src="//cdnjs.cloudflare.com/ajax/libs/jstree/3.3.3/jstree.min.js"></script>    <script>        $(function () {            // Container tree users            const container = $('#staffTree');            $.ajaxSetup({                headers: {                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')                }            });            /**             * Get tree users from database from start download             */            $.ajax({                type: "POST",                url: '/staff_tree',                data: JSON.stringify({}),                success: function (data) {                    container.jstree({                        'core': {                            'check_callback': true,                            'data': [                                createTreeComponentUser(data)                            ]                        }                    });                }            })            /**             *  Create start tree users 1 and 2 positions             */            function createTreeComponentUser(user) {                let childrenItems = [];                user.map((items) =>                    childrenItems.push({                        "text": [items.child_users.surname, items.child_users.position_id, items.child_users.id],                        "id": items.child_users.id,                    })                )                return ({                    "text": [user[0].parent_users.surname, user[0].parent_users.position_id, user[0].parent_users.id],                    "id": user[0].parent_users.id,                    "children": childrenItems                });            }            /**             *  Add new node under parent             */            container.on("click", function (event) {                let targetUserId = $(event.target).closest('.jstree-node').attr('id');                if (targetUserId !== '1') {                    $.ajax({                        type: "GET",                        url: "/staff_tree/" + targetUserId,                        data: JSON.stringify({}),                        success: function (data) {                            if (data.length) {                                if (!container.jstree(true).get_node(data[0].child_users.id)) {                                    data.map(item => {                                        container.jstree().create_node(item.user_parent_id, {                                            "text": [                                                item.child_users.surname,                                                item.child_users.position_id,                                                item.child_users.id                                            ],                                            "id": item.child_users.id,                                        }, "last");                                    })                                }                            }                        }                    })                }            });            /**             * Create tree component each users             */            // function createTreeComponentUser(user) {            //     return ([            //         '<div key="' + user.id + '"' +            //         '<div className="app-left-block">' +            //         '<img src={checkIfImage(user.image)} className="app-tree-image"/>' +            //         '</div>' +            //         '<div className="app-right-block">' +            //         '<div className="app-up-block">' +            //         '<span className="app-user-name">Full name: ' + user.surname + ' ' + user.first_name + ' ' + user.patronymic + ' </span>' +            //         '<span className="app-user-position">Position: number-"' + user.position_id + '",</span>' +            //         '</div>' +            //         '<div className="app-down-block">' +            //         '<span className="app-user-pay-amount">Salary: "' + user.amount_of_wages + '"UAN,</span>' +            //         '<span className="app-user-start-date">Employment date: "' + user.date_engagement + '".</span>' +            //         '</div>' +            //         '</div> ' +            //         '</div>'            //     ]);            // }            /**             * Check user have own image or show default             *             * @param path_image             * @returns {*}             */            function checkIfImage(path_image) {                return (path_image) ? path_image : 'img/default.png';            }        });        //onClick={(e) =>"'+ this.getUsersToPosition(e, user) + '">    </script>@endpush