$(function () {    // Container tree users    const container = $('#staffTree');    $.ajaxSetup({        headers: {            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')        }    });    /**     * Get tree users from database from start download     */    $.ajax({        type: "POST",        url: '/staff_tree',        data: JSON.stringify({}),        success: function (data) {            container.jstree({                'core': {                    'check_callback': true,                    'data': createTreeComponentUser(data)                },                // "plugins" : [ "search", "dnd" ],            });        }    })    /**     *  Create start tree users 1 pisition     */    function createTreeComponentUser(user) {        let childrenItems = [];        user.map((items) =>            childrenItems.push({                "icon": checkIfImage(items.image),                "text": [                    '<div class="app-right"><b class="app-badge-name">Name: ' + items.surname + ' ' + items.first_name +                    ' ' + items.patronymic + '</b>',                    '<b class="app-badge-posit">Position: ' + items.position.position_name + '</b>',                    '<br><b class="app-badge-date">Date Enagement: ' + items.date_engagement + '</b>',                    '<b class="app-badge-salary">Salary: ' + items.amount_of_wages + ' UAN</b></div>',                ],                "id": items.id,            })        )        return childrenItems;    }    /**     *  Add new node under parent     */    container.on("click", function (event) {        let targetUserId = $(event.target).closest('.jstree-node').attr('id');        $.ajax({            type: "GET",            url: "/staff_tree/" + targetUserId,            data: JSON.stringify({}),            success: function (data) {                if (data.length) {                    if (!container.jstree(true).get_node(data[0].child_users.id)) {                        data.map(items => {                            container.jstree().create_node(items.user_parent_id, {                                "icon": checkIfImage(items.child_users.image),                                "text": [                                    '<div class="app-right"><b class="app-badge-name">Name: ' + items.child_users.surname                                    + ' ' + items.child_users.first_name + ' ' + items.child_users.patronymic + '</b>',                                    '<b class="app-badge-posit">Position: Worker Level ' + items.child_users.position_id + '</b>',                                    '<br><b class="app-badge-date">Date Enagement: ' + items.child_users.date_engagement + '</b>',                                    '<b class="app-badge-salary">Salary: ' + items.child_users.amount_of_wages + ' UAN</b></div>',                                ],                                "id": items.child_users.id,                            }, "last");                        })                    }                }            }        })        // }    });    /**     * Check user have own image or show default     *     * @param path_image     * @returns {*}     */    function checkIfImage(path_image) {        return (path_image) ? '/image_upload/' + path_image : '/img/default.png';    }});